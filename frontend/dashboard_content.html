<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h3 class="card-title">Candidate Assignments & Tests</h3>
  </div>

  <div class="card-body">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>Candidate Name</th>
          <th>Email</th>
          <th>Assignment / Test Title</th>
          <th>Due Date</th>
          <th>Type</th>
          <th>Status</th>
          <th>Verification Status</th>

          <!-- üî• NEW: Result Page -->
          <th>Result</th>

          <th>Delete</th>
        </tr>
      </thead>

      <tbody>
        {% for a in assignments %}
        <tr>

          <td>{{ a.candidate_name }}</td>
          <td>{{ a.candidate_email }}</td>
          <td>{{ a.title }}</td>
          <td>{{ a.due_date }}</td>
          <td>{{ a.job_type }}</td>

          <!-- STATUS -->
          <td>{{ a.status }}</td>

          <!-- TEST/ASSIGNMENT VERIFICATION STATUS -->
          <td>
            {% if a.verification_status %}
              {{ a.verification_status }}
            {% else %}
              Pending
            {% endif %}
          </td>

          <!-- NEW: RESULT PAGE -->
          <td>
            <a href="{{ a.result_link }}" class="btn btn-primary btn-sm">Open</a>
          </td>

          <!-- DELETE BUTTON -->
          <td>
             {% if a.job_type == "Test" or a.title == "Test Submission" %}
              <!-- Delete TEST -->
                <form action="/delete-test-submission/{{ a.test_id }}" method="post"
                  onsubmit="return confirm('Delete this candidate\'s test submission?');">
                  <input type="hidden" name="candidate_email" value="{{ a.candidate_email }}">
                  <button class="btn btn-danger btn-sm" title="Delete Submission">‚ùå</button>
                </form>

             {% else %}
              <!-- Delete ASSIGNMENT -->
				<form action="/delete-assignment-list/{{ a.assignment_id }}" method="post"
                  onsubmit="return confirm('Delete this candidate\'s submission?');">
                  <input type="hidden" name="candidate_email" value="{{ a.candidate_email }}">
                  <button class="btn btn-danger btn-sm" title="Delete Submission">‚ùå</button>
                </form>


             {% endif %}
          </td>

        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
